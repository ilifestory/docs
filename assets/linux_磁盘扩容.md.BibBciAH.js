import{_ as e,c as a,o as s,a4 as l,b$ as n,c0 as p,c1 as o,c2 as t}from"./chunks/framework.CCJHkvW2.js";const C=JSON.parse('{"title":"磁盘扩容","description":"","frontmatter":{},"headers":[],"relativePath":"linux/磁盘扩容.md","filePath":"linux/磁盘扩容.md","lastUpdated":1710736177000}'),i={name:"linux/磁盘扩容.md"},r=l('<h1 id="磁盘扩容" tabindex="-1">磁盘扩容 <a class="header-anchor" href="#磁盘扩容" aria-label="Permalink to &quot;磁盘扩容&quot;">​</a></h1><h2 id="扩容到跟-目录" tabindex="-1">扩容到跟(/)目录 <a class="header-anchor" href="#扩容到跟-目录" aria-label="Permalink to &quot;扩容到跟(/)目录&quot;">​</a></h2><h3 id="_1、查看新括容的硬盘-比如-dev-vdb-为新扩容的硬盘" tabindex="-1">1、查看新括容的硬盘（比如 /dev/vdb 为新扩容的硬盘） <a class="header-anchor" href="#_1、查看新括容的硬盘-比如-dev-vdb-为新扩容的硬盘" aria-label="Permalink to &quot;1、查看新括容的硬盘（比如 /dev/vdb 为新扩容的硬盘）&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">fdisk</span><span style="color:#C3E88D;"> -l</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2、创建pv-名称为-dev-vdb" tabindex="-1">2、创建PV,名称为/dev/vdb <a class="header-anchor" href="#_2、创建pv-名称为-dev-vdb" aria-label="Permalink to &quot;2、创建PV,名称为/dev/vdb&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">pvcreate</span><span style="color:#C3E88D;"> /dev/vdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3、扩展vg-将pv扩展到vg中" tabindex="-1">3、扩展VG(将PV扩展到VG中) <a class="header-anchor" href="#_3、扩展vg-将pv扩展到vg中" aria-label="Permalink to &quot;3、扩展VG(将PV扩展到VG中)&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">pvdisplay</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">vgdisplay</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">vgextend</span><span style="color:#C3E88D;"> centos</span><span style="color:#C3E88D;"> /dev/vdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4、设置扩展vg的容量" tabindex="-1">4、设置扩展VG的容量 <a class="header-anchor" href="#_4、设置扩展vg的容量" aria-label="Permalink to &quot;4、设置扩展VG的容量&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">lvextend</span><span style="color:#C3E88D;"> -l</span><span style="color:#C3E88D;"> +100%FREE</span><span style="color:#C3E88D;"> /dev/mapper/centos-root</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>或</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">lvextend</span><span style="color:#C3E88D;">  -L</span><span style="color:#C3E88D;">   +500G</span><span style="color:#C3E88D;">  /dev/mapper/centos-root</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_5、启用扩展容量" tabindex="-1">5、启用扩展容量 <a class="header-anchor" href="#_5、启用扩展容量" aria-label="Permalink to &quot;5、启用扩展容量&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">xfs_growfs</span><span style="color:#C3E88D;">  /dev/mapper/centos-root</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="扩容到指定目录-如-extend目录" tabindex="-1">扩容到指定目录(如/extend目录) <a class="header-anchor" href="#扩容到指定目录-如-extend目录" aria-label="Permalink to &quot;扩容到指定目录(如/extend目录)&quot;">​</a></h2><h3 id="_1、查看新括容的硬盘-比如-dev-vdb-为新扩容的硬盘-1" tabindex="-1">1、查看新括容的硬盘（比如 /dev/vdb 为新扩容的硬盘） <a class="header-anchor" href="#_1、查看新括容的硬盘-比如-dev-vdb-为新扩容的硬盘-1" aria-label="Permalink to &quot;1、查看新括容的硬盘（比如 /dev/vdb 为新扩容的硬盘）&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">fdisk</span><span style="color:#C3E88D;"> -l</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2、创建pv-名称为-dev-vdb-1" tabindex="-1">2、创建PV,名称为/dev/vdb <a class="header-anchor" href="#_2、创建pv-名称为-dev-vdb-1" aria-label="Permalink to &quot;2、创建PV,名称为/dev/vdb&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">pvcreate</span><span style="color:#C3E88D;"> /dev/vdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3、创建vg-名称为vg-20220704" tabindex="-1">3、创建VG,名称为vg_20220704 <a class="header-anchor" href="#_3、创建vg-名称为vg-20220704" aria-label="Permalink to &quot;3、创建VG,名称为vg_20220704&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">pvdisplay</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">vgcreate</span><span style="color:#C3E88D;"> vg_20220704</span><span style="color:#C3E88D;"> /dev/vdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4、创建lv-名称为lv-20220704并且容量为100" tabindex="-1">4、创建LV,名称为lv_20220704并且容量为100% <a class="header-anchor" href="#_4、创建lv-名称为lv-20220704并且容量为100" aria-label="Permalink to &quot;4、创建LV,名称为lv_20220704并且容量为100%&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">vgdisplay</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">lvcreate</span><span style="color:#C3E88D;"> -l</span><span style="color:#C3E88D;"> 100%VG</span><span style="color:#C3E88D;"> -n</span><span style="color:#C3E88D;"> lv_20220704</span><span style="color:#C3E88D;"> vg_20220704</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_5、格式化lv-即lv-20220704" tabindex="-1">5、格式化LV（即lv_20220704） <a class="header-anchor" href="#_5、格式化lv-即lv-20220704" aria-label="Permalink to &quot;5、格式化LV（即lv_20220704）&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">lvdisplay</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mkfs.xfs</span><span style="color:#C3E88D;"> /dev/vg_20220704/lv_20220704</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_6、将lv挂载到指定目录-如-extend目录" tabindex="-1">6、将LV挂载到指定目录(如/extend目录) <a class="header-anchor" href="#_6、将lv挂载到指定目录-如-extend目录" aria-label="Permalink to &quot;6、将LV挂载到指定目录(如/extend目录)&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">    mount</span><span style="color:#C3E88D;"> /dev/vg_20220704/lv_20220704</span><span style="color:#C3E88D;"> /extend</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_7、设置开机自动挂载" tabindex="-1">7、设置开机自动挂载 <a class="header-anchor" href="#_7、设置开机自动挂载" aria-label="Permalink to &quot;7、设置开机自动挂载&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">    vim</span><span style="color:#C3E88D;"> /etc/fstab</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>加入内容为：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">/dev/vg_20220704/lv_20220704</span><span style="color:#C3E88D;">    /extend</span><span style="color:#C3E88D;">       xfs</span><span style="color:#C3E88D;">    defaults</span><span style="color:#F78C6C;">        0</span><span style="color:#F78C6C;"> 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="根目录空间不足-把home下追加空间到根目录下" tabindex="-1">根目录空间不足，把home下追加空间到根目录下 <a class="header-anchor" href="#根目录空间不足-把home下追加空间到根目录下" aria-label="Permalink to &quot;根目录空间不足，把home下追加空间到根目录下&quot;">​</a></h2><p>最近在爬虫，要保存大量的源码在linux上，最后发现根目录不足，想要追加根目录的空间，我的系统是centos7，还好之前分配了一整个系统盘给centos，有200g，根目录目前使用了50g，现在从home目录分配100g给root目录，剩50g给自己，也就是home目录，我目前就给home留了40g，之前都给的时候出了些小问提，还没琢磨出来，就少分一点，我们先用着，可能是 Free PE 的问题 。如果是安装时候硬盘空间用完了，也可以进行再挂载一个硬盘进行追加空间。</p><p>我们先来说第一种情况：</p><p>主要的思路大体上面已经说了，再详细说一遍：First： 我们先把/home内容进行备份，这里我们就备份到我们的临时目录 tmp 目录下；</p><p>Second：然后将/home文件系统所在的逻辑卷删除；</p><p>Third：这边我们就可以进行扩大/root文件系统；</p><p>Forth：删除了home，就要新建一个/home；</p><p>Fiveth：最后恢复/home内容，就是把tmp目录我们刚刚压缩的，给恢复过来。</p><p>查看分区的状态：</p><p>敲入命令：df -h ，然后可以看到我现在的根目录没剩多少空间了，home的空间比较充足，我们给他分过来一些。</p><p><img src="'+n+'" alt="An image"></p><p>我们先进行home目录的备份</p><p>敲入命令：tar cvf /tmp/home.tar /home</p><p>然后呢，我们就卸载home目录：</p><p>敲入命令：第一条：fuser -km /home/</p><p>第二条：umount /home</p><p>第三条：lvremove /dev/mapper/centos-home （删除home目录所在的lv）敲完这命令后会有相应的提示，输入y按enter就可以。</p><p>现在此刻就没有home目录啦，不信你自己df -h看看，接下来我们卸载home目录之后，我们系统现在有147g的空间，我们拿出100g，给我们的根目录</p><p>敲入命令：lvextend -L +100G /dev/mapper/centos-root</p><p><img src="'+p+'" alt="An image"></p><p>现在空间是追加了，然后就是要扩展/root的文件系统啦</p><p>敲入命令：xfs_growfs /dev/mapper/centos-root</p><p><img src="'+o+'" alt="An image"></p><p>接下来根目录处理好了，我们来处理home目录，先重新创建home目录的lv</p><p>敲入命令：lvcreate -L 40G -n /dev/mapper/centos-home</p><p>然后进行创建文件系统</p><p>敲入命令：mkfs.xfs /dev/mapper/centos-home</p><p><img src="'+t+'" alt="An image"></p><p>接下来我们就要把home目录挂载回去</p><p>敲入命令：mount /dev/mapper/centos-home</p><p>最后把之前home备份到tmp的内容，给mv回来，home目录的恢复</p><p>敲入命令：第一条 解压 ：tar xvf /tmp/home.tar -C /home/ 第二条 我们解压在home 所以要进入home目录 ：cd /home/home/ 最后一条：mv * ../</p><p>然后你在敲df -h，就可以看到现在的系统状态，大功告成！</p>',69),d=[r];function c(h,v,m,b,u,g){return s(),a("div",null,d)}const _=e(i,[["render",c]]);export{C as __pageData,_ as default};
