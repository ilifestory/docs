import{_ as s,c as n,o as a,a4 as l,bb as p,bc as e,bd as o,be as t,bf as r,bg as c}from"./chunks/framework.CCJHkvW2.js";const E=JSON.parse('{"title":"tky视频识别项目全流程","description":"","frontmatter":{},"headers":[],"relativePath":"ai/视频图片车辆识别.md","filePath":"ai/视频图片车辆识别.md","lastUpdated":1699424530000}'),i={name:"ai/视频图片车辆识别.md"},y=l('<h1 id="tky视频识别项目全流程" tabindex="-1">tky视频识别项目全流程 <a class="header-anchor" href="#tky视频识别项目全流程" aria-label="Permalink to &quot;tky视频识别项目全流程&quot;">​</a></h1><h2 id="安装python3" tabindex="-1">安装python3 <a class="header-anchor" href="#安装python3" aria-label="Permalink to &quot;安装python3&quot;">​</a></h2><p><img src="'+p+'" alt="An image"></p><h2 id="数据收集-收集和准备海量的数据。" tabindex="-1">数据收集：收集和准备海量的数据。 <a class="header-anchor" href="#数据收集-收集和准备海量的数据。" aria-label="Permalink to &quot;数据收集：收集和准备海量的数据。&quot;">​</a></h2><p>1️⃣ 安装标记工具</p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/%E6%A0%87%E6%B3%A8%E6%95%99%E7%A8%8B%E5%92%8C%E5%B7%A5%E5%85%B7.zip" target="_blank" rel="noreferrer">点击下载标记工具Labelme</a><img src="'+e+'" alt="An image"></p><p>打开Labelme如下图 <a href="./labelme.html">Labelme详细使用说明</a></p><p><img src="'+o+'" alt="An image"></p><p><img src="'+t+`" alt="An image"></p><p>Ctrl + s 保存打的标签, 会生成同<code>图片名称同名</code>的<code>json</code>文件</p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/202307041056158.json" target="_blank" rel="noreferrer">点击下载Json文件</a></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">5.2.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">flags</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {},</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">shapes</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">label</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">points</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          910.609756097561</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          433.9024390243902</span></span>
<span class="line"><span style="color:#89DDFF;">        ],</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          1482.560975609756</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          1018.0487804878048</span></span>
<span class="line"><span style="color:#89DDFF;">        ]</span></span>
<span class="line"><span style="color:#89DDFF;">      ],</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">group_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">shape_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">rectangle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">flags</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {}</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">label</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">truck</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">points</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          750.8536585365854</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          10.73170731707318</span></span>
<span class="line"><span style="color:#89DDFF;">        ],</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          931.3414634146342</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          219.2682926829268</span></span>
<span class="line"><span style="color:#89DDFF;">        ]</span></span>
<span class="line"><span style="color:#89DDFF;">      ],</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">group_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">shape_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">rectangle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">flags</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {}</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">label</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">points</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          1291.0975609756097</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          225.3658536585366</span></span>
<span class="line"><span style="color:#89DDFF;">        ],</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          1593.5365853658536</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          472.9268292682927</span></span>
<span class="line"><span style="color:#89DDFF;">        ]</span></span>
<span class="line"><span style="color:#89DDFF;">      ],</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">group_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">shape_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">rectangle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">flags</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {}</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">label</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">points</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          989.8780487804878</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          157.07317073170734</span></span>
<span class="line"><span style="color:#89DDFF;">        ],</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          1158.1707317073171</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          296.0975609756098</span></span>
<span class="line"><span style="color:#89DDFF;">        ]</span></span>
<span class="line"><span style="color:#89DDFF;">      ],</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">group_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">shape_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">rectangle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">flags</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {}</span></span>
<span class="line"><span style="color:#89DDFF;">    },</span></span>
<span class="line"><span style="color:#89DDFF;">    {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">label</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">points</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          1337.439024390244</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          82.6829268292683</span></span>
<span class="line"><span style="color:#89DDFF;">        ],</span></span>
<span class="line"><span style="color:#89DDFF;">        [</span></span>
<span class="line"><span style="color:#F78C6C;">          1469.1463414634145</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F78C6C;">          176.58536585365854</span></span>
<span class="line"><span style="color:#89DDFF;">        ]</span></span>
<span class="line"><span style="color:#89DDFF;">      ],</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">group_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> null,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">shape_type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">rectangle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#FFCB6B;">flags</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {}</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">  ],</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">imagePath</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">202307041056158.jpg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">imageData</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/9j/4AAQSkZaj/4VqmSWiWLzAu......AOqRT0oooAexAHqKioooA//9k=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">imageHeight</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1080</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">imageWidth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1920</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br></div></div><p>2️⃣ 通过程序将<code>json</code>文件转成模型训练需要的<code>txt</code>文件 包括: <code>train , test ,val</code></p><p>train: 训练集</p><p>test: 测试集</p><p>val: 验证集</p><p><img src="`+r+`" alt="An image"></p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/train.txt" target="_blank" rel="noreferrer">点击下载train.txt文件</a></p><p>train.txt</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>truck_plate/images/20230411012301_WSN20221020B5_GW20221020B51.jpg</span></span>
<span class="line"><span>truck_plate/images/20230411012301_WSN20221020B5_GW20221020B5103.jpg</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/test.txt" target="_blank" rel="noreferrer">点击下载test.txt文件</a></p><p>test.txt</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>truck_plate/images/1271061_1271061.jpg</span></span>
<span class="line"><span>truck_plate/images/1271069_1271069.jpg</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>另一个目录下的train.txt</p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/train(1).txt" target="_blank" rel="noreferrer">点击下载另一个目录下需要的train.txt文件</a></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>20230411012301_WSN20221020B5_GW20221020B51</span></span>
<span class="line"><span>20230411012301_WSN20221020B5_GW20221020B5103</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>另一个目录下的test.txt</p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/test1.txt" target="_blank" rel="noreferrer">点击下载另一个目录下需要的test.txt文件</a></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>1271061_1271061</span></span>
<span class="line"><span>1271069_1271069</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>图片文件同名的.txt eg: <code>20230411012301_WSN20221020B5_GW20221020B51.txt</code></p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/20230411012301_WSN20221020B5_GW20221020B51.txt" target="_blank" rel="noreferrer">点击下载图片文件同名的.txt文件</a></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>0 0.5087386526208009 0.5310866013071897 0.9766991189670919 0.9341230936819171</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="设计模型-设计模型结构和参数。" tabindex="-1">设计模型：设计模型结构和参数。 <a class="header-anchor" href="#设计模型-设计模型结构和参数。" aria-label="Permalink to &quot;设计模型：设计模型结构和参数。&quot;">​</a></h2><p>通过开源的yolov8模型 <img src="`+c+`" alt="An image"></p><h2 id="模型训练-进行模型的训练-进行模型优化。" tabindex="-1">模型训练：进行模型的训练，进行模型优化。 <a class="header-anchor" href="#模型训练-进行模型的训练-进行模型优化。" aria-label="Permalink to &quot;模型训练：进行模型的训练，进行模型优化。&quot;">​</a></h2><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#C3E88D;"> clone</span><span style="color:#C3E88D;"> https://github.com/ultralytics/ultralytics.git</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#C3E88D;"> ultralytics</span></span>
<span class="line"><span style="color:#FFCB6B;">pip</span><span style="color:#C3E88D;"> install</span><span style="color:#C3E88D;"> -r</span><span style="color:#C3E88D;"> requirements.txt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>将制作好的数据集放入<code>ultralytics</code>目录</p><p>修改数据集配置文件<code>ultralytics/datasets/coco.yaml</code> 相关路径根据实际路径修改</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># COCO 2017 dataset http://cocodataset.org</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Train command: python train.py --data coco.yaml</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Default dataset location is next to /yolov5:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#   /parent_folder</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#     /coco</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#     /yolov5</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># download command/URL (optional)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># download: bash data/scripts/get_coco.sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># train and val data as 1) directory: path/images/, 2) file: path/images.txt, or 3) list: [path1/images/, path2/images/]</span></span>
<span class="line"><span style="color:#FFCB6B;">train:</span><span style="color:#C3E88D;"> F:</span><span style="color:#BABED8;">\\p</span><span style="color:#C3E88D;">engzhuang3.0</span><span style="color:#BABED8;">\\u</span><span style="color:#C3E88D;">ltralytics-main</span><span style="color:#BABED8;">\\t</span><span style="color:#C3E88D;">ruck_plate/train.txt</span><span style="color:#676E95;font-style:italic;">  # 118287 images</span></span>
<span class="line"><span style="color:#FFCB6B;">val:</span><span style="color:#C3E88D;"> F:</span><span style="color:#BABED8;">\\p</span><span style="color:#C3E88D;">engzhuang3.0</span><span style="color:#BABED8;">\\u</span><span style="color:#C3E88D;">ltralytics-main</span><span style="color:#BABED8;">\\t</span><span style="color:#C3E88D;">ruck_plate/test.txt</span><span style="color:#676E95;font-style:italic;"> # 5000 images</span></span>
<span class="line"><span style="color:#82AAFF;">test</span><span style="color:#C3E88D;">:</span><span style="color:#C3E88D;"> F:</span><span style="color:#BABED8;">\\p</span><span style="color:#C3E88D;">engzhuang3.0</span><span style="color:#BABED8;">\\u</span><span style="color:#C3E88D;">ltralytics-main</span><span style="color:#BABED8;">\\t</span><span style="color:#C3E88D;">ruck_plate/val.txt</span><span style="color:#676E95;font-style:italic;">  # 20288 of 40670 images, submit to https://competitions.codalab.org/competitions/20794</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">names:</span></span>
<span class="line"><span style="color:#FFCB6B;">  0:</span><span style="color:#C3E88D;"> truck</span></span>
<span class="line"><span style="color:#FFCB6B;">  1:</span><span style="color:#C3E88D;"> bus</span></span>
<span class="line"><span style="color:#FFCB6B;">  2:</span><span style="color:#C3E88D;"> car</span></span>
<span class="line"><span style="color:#FFCB6B;">  3:</span><span style="color:#C3E88D;"> plate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">nc:</span><span style="color:#F78C6C;"> 4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>修改 yolov8 调参配置文件， 根据自己的电脑能力或任务场景</p><p>默认配置目录为<code>ultralytics/yolo/cfg/default.yaml</code></p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Ultralytics YOLO 🚀, AGPL-3.0 license</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Default training settings and hyperparameters for medium-augmentation COCO training</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">task:</span><span style="color:#C3E88D;"> detect</span><span style="color:#676E95;font-style:italic;">  # YOLO task, i.e. detect, segment, classify, pose</span></span>
<span class="line"><span style="color:#FFCB6B;">mode:</span><span style="color:#C3E88D;"> train</span><span style="color:#676E95;font-style:italic;">  # YOLO mode, i.e. train, val, predict, export, track, benchmark</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Train settings -------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">model:</span><span style="color:#676E95;font-style:italic;">  # path to model file, i.e. yolov8n.pt, yolov8n.yaml</span></span>
<span class="line"><span style="color:#FFCB6B;">data:</span><span style="color:#676E95;font-style:italic;">  # path to data file, i.e. coco128.yaml</span></span>
<span class="line"><span style="color:#FFCB6B;">epochs:</span><span style="color:#F78C6C;"> 100</span><span style="color:#676E95;font-style:italic;">  # number of epochs to train for</span></span>
<span class="line"><span style="color:#FFCB6B;">patience:</span><span style="color:#F78C6C;"> 50</span><span style="color:#676E95;font-style:italic;">  # epochs to wait for no observable improvement for early stopping of training</span></span>
<span class="line"><span style="color:#FFCB6B;">batch:</span><span style="color:#F78C6C;"> 16</span><span style="color:#676E95;font-style:italic;">  # number of images per batch (-1 for AutoBatch)</span></span>
<span class="line"><span style="color:#FFCB6B;">imgsz:</span><span style="color:#F78C6C;"> 640</span><span style="color:#676E95;font-style:italic;">  # size of input images as integer or w,h</span></span>
<span class="line"><span style="color:#FFCB6B;">save:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # save train checkpoints and predict results</span></span>
<span class="line"><span style="color:#FFCB6B;">save_period:</span><span style="color:#C3E88D;"> -1</span><span style="color:#676E95;font-style:italic;"> # Save checkpoint every x epochs (disabled if &lt; 1)</span></span>
<span class="line"><span style="color:#FFCB6B;">cache:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # True/ram, disk or False. Use cache for data loading</span></span>
<span class="line"><span style="color:#FFCB6B;">device:</span><span style="color:#676E95;font-style:italic;">  # device to run on, i.e. cuda device=0 or device=0,1,2,3 or device=cpu</span></span>
<span class="line"><span style="color:#FFCB6B;">workers:</span><span style="color:#F78C6C;"> 2</span><span style="color:#676E95;font-style:italic;">  # number of worker threads for data loading (per RANK if DDP)</span></span>
<span class="line"><span style="color:#FFCB6B;">project:</span><span style="color:#676E95;font-style:italic;">  # project name</span></span>
<span class="line"><span style="color:#FFCB6B;">name:</span><span style="color:#676E95;font-style:italic;">  # experiment name, results saved to &#39;project/name&#39; directory</span></span>
<span class="line"><span style="color:#FFCB6B;">exist_ok:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # whether to overwrite existing experiment</span></span>
<span class="line"><span style="color:#FFCB6B;">pretrained:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # whether to use a pretrained model</span></span>
<span class="line"><span style="color:#FFCB6B;">optimizer:</span><span style="color:#C3E88D;"> SGD</span><span style="color:#676E95;font-style:italic;">  # optimizer to use, choices=[&#39;SGD&#39;, &#39;Adam&#39;, &#39;AdamW&#39;, &#39;RMSProp&#39;]</span></span>
<span class="line"><span style="color:#FFCB6B;">verbose:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # whether to print verbose output</span></span>
<span class="line"><span style="color:#FFCB6B;">seed:</span><span style="color:#F78C6C;"> 0</span><span style="color:#676E95;font-style:italic;">  # random seed for reproducibility</span></span>
<span class="line"><span style="color:#FFCB6B;">deterministic:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # whether to enable deterministic mode</span></span>
<span class="line"><span style="color:#FFCB6B;">single_cls:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # train multi-class data as single-class</span></span>
<span class="line"><span style="color:#FFCB6B;">rect:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # rectangular training if mode=&#39;train&#39; or rectangular validation if mode=&#39;val&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">cos_lr:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # use cosine learning rate scheduler</span></span>
<span class="line"><span style="color:#FFCB6B;">close_mosaic:</span><span style="color:#F78C6C;"> 0</span><span style="color:#676E95;font-style:italic;">  # (int) disable mosaic augmentation for final epochs</span></span>
<span class="line"><span style="color:#FFCB6B;">resume:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # resume training from last checkpoint</span></span>
<span class="line"><span style="color:#FFCB6B;">amp:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # Automatic Mixed Precision (AMP) training, choices=[True, False], True runs AMP check</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Segmentation</span></span>
<span class="line"><span style="color:#FFCB6B;">overlap_mask:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # masks should overlap during training (segment train only)</span></span>
<span class="line"><span style="color:#FFCB6B;">mask_ratio:</span><span style="color:#F78C6C;"> 4</span><span style="color:#676E95;font-style:italic;">  # mask downsample ratio (segment train only)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Classification</span></span>
<span class="line"><span style="color:#FFCB6B;">dropout:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # use dropout regularization (classify train only)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Val/Test settings ----------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">val:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # validate/test during training</span></span>
<span class="line"><span style="color:#FFCB6B;">split:</span><span style="color:#C3E88D;"> val</span><span style="color:#676E95;font-style:italic;">  # dataset split to use for validation, i.e. &#39;val&#39;, &#39;test&#39; or &#39;train&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">save_json:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # save results to JSON file</span></span>
<span class="line"><span style="color:#FFCB6B;">save_hybrid:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # save hybrid version of labels (labels + additional predictions)</span></span>
<span class="line"><span style="color:#FFCB6B;">conf:</span><span style="color:#676E95;font-style:italic;">  # object confidence threshold for detection (default 0.25 predict, 0.001 val)</span></span>
<span class="line"><span style="color:#FFCB6B;">iou:</span><span style="color:#F78C6C;"> 0.7</span><span style="color:#676E95;font-style:italic;">  # intersection over union (IoU) threshold for NMS</span></span>
<span class="line"><span style="color:#FFCB6B;">max_det:</span><span style="color:#F78C6C;"> 300</span><span style="color:#676E95;font-style:italic;">  # maximum number of detections per image</span></span>
<span class="line"><span style="color:#FFCB6B;">half:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # use half precision (FP16)</span></span>
<span class="line"><span style="color:#FFCB6B;">dnn:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # use OpenCV DNN for ONNX inference</span></span>
<span class="line"><span style="color:#FFCB6B;">plots:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # save plots during train/val</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Prediction settings --------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#82AAFF;">source</span><span style="color:#C3E88D;">:</span><span style="color:#676E95;font-style:italic;">  # source directory for images or videos</span></span>
<span class="line"><span style="color:#FFCB6B;">show:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # show results if possible</span></span>
<span class="line"><span style="color:#FFCB6B;">save_txt:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # save results as .txt file</span></span>
<span class="line"><span style="color:#FFCB6B;">save_conf:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # save results with confidence scores</span></span>
<span class="line"><span style="color:#FFCB6B;">save_crop:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # save cropped images with results</span></span>
<span class="line"><span style="color:#FFCB6B;">show_labels:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # show object labels in plots</span></span>
<span class="line"><span style="color:#FFCB6B;">show_conf:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # show object confidence scores in plots</span></span>
<span class="line"><span style="color:#FFCB6B;">vid_stride:</span><span style="color:#F78C6C;"> 1</span><span style="color:#676E95;font-style:italic;">  # video frame-rate stride</span></span>
<span class="line"><span style="color:#FFCB6B;">line_width:</span><span style="color:#676E95;font-style:italic;">   # line width of the bounding boxes</span></span>
<span class="line"><span style="color:#FFCB6B;">visualize:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # visualize model features</span></span>
<span class="line"><span style="color:#FFCB6B;">augment:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # apply image augmentation to prediction sources</span></span>
<span class="line"><span style="color:#FFCB6B;">agnostic_nms:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # class-agnostic NMS</span></span>
<span class="line"><span style="color:#FFCB6B;">classes:</span><span style="color:#676E95;font-style:italic;">  # filter results by class, i.e. class=0, or class=[0,2,3]</span></span>
<span class="line"><span style="color:#FFCB6B;">retina_masks:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # use high-resolution segmentation masks</span></span>
<span class="line"><span style="color:#FFCB6B;">boxes:</span><span style="color:#C3E88D;"> True</span><span style="color:#676E95;font-style:italic;">  # Show boxes in segmentation predictions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Export settings ------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">format:</span><span style="color:#C3E88D;"> torchscript</span><span style="color:#676E95;font-style:italic;">  # format to export to</span></span>
<span class="line"><span style="color:#FFCB6B;">keras:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # use Keras</span></span>
<span class="line"><span style="color:#FFCB6B;">optimize:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # TorchScript: optimize for mobile</span></span>
<span class="line"><span style="color:#FFCB6B;">int8:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # CoreML/TF INT8 quantization</span></span>
<span class="line"><span style="color:#FFCB6B;">dynamic:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # ONNX/TF/TensorRT: dynamic axes</span></span>
<span class="line"><span style="color:#FFCB6B;">simplify:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # ONNX: simplify model</span></span>
<span class="line"><span style="color:#FFCB6B;">opset:</span><span style="color:#676E95;font-style:italic;">  # ONNX: opset version (optional)</span></span>
<span class="line"><span style="color:#FFCB6B;">workspace:</span><span style="color:#F78C6C;"> 4</span><span style="color:#676E95;font-style:italic;">  # TensorRT: workspace size (GB)</span></span>
<span class="line"><span style="color:#FFCB6B;">nms:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # CoreML: add NMS</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Hyperparameters ------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">lr0:</span><span style="color:#F78C6C;"> 0.01</span><span style="color:#676E95;font-style:italic;">  # initial learning rate (i.e. SGD=1E-2, Adam=1E-3)</span></span>
<span class="line"><span style="color:#FFCB6B;">lrf:</span><span style="color:#F78C6C;"> 0.01</span><span style="color:#676E95;font-style:italic;">  # final learning rate (lr0 * lrf)</span></span>
<span class="line"><span style="color:#FFCB6B;">momentum:</span><span style="color:#F78C6C;"> 0.937</span><span style="color:#676E95;font-style:italic;">  # SGD momentum/Adam beta1</span></span>
<span class="line"><span style="color:#FFCB6B;">weight_decay:</span><span style="color:#F78C6C;"> 0.0005</span><span style="color:#676E95;font-style:italic;">  # optimizer weight decay 5e-4</span></span>
<span class="line"><span style="color:#FFCB6B;">warmup_epochs:</span><span style="color:#F78C6C;"> 3.0</span><span style="color:#676E95;font-style:italic;">  # warmup epochs (fractions ok)</span></span>
<span class="line"><span style="color:#FFCB6B;">warmup_momentum:</span><span style="color:#F78C6C;"> 0.8</span><span style="color:#676E95;font-style:italic;">  # warmup initial momentum</span></span>
<span class="line"><span style="color:#FFCB6B;">warmup_bias_lr:</span><span style="color:#F78C6C;"> 0.1</span><span style="color:#676E95;font-style:italic;">  # warmup initial bias lr</span></span>
<span class="line"><span style="color:#FFCB6B;">box:</span><span style="color:#F78C6C;"> 7.5</span><span style="color:#676E95;font-style:italic;">  # box loss gain</span></span>
<span class="line"><span style="color:#FFCB6B;">cls:</span><span style="color:#F78C6C;"> 0.5</span><span style="color:#676E95;font-style:italic;">  # cls loss gain (scale with pixels)</span></span>
<span class="line"><span style="color:#FFCB6B;">dfl:</span><span style="color:#F78C6C;"> 1.5</span><span style="color:#676E95;font-style:italic;">  # dfl loss gain</span></span>
<span class="line"><span style="color:#FFCB6B;">pose:</span><span style="color:#F78C6C;"> 12.0</span><span style="color:#676E95;font-style:italic;">  # pose loss gain</span></span>
<span class="line"><span style="color:#FFCB6B;">kobj:</span><span style="color:#F78C6C;"> 1.0</span><span style="color:#676E95;font-style:italic;">  # keypoint obj loss gain</span></span>
<span class="line"><span style="color:#FFCB6B;">label_smoothing:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # label smoothing (fraction)</span></span>
<span class="line"><span style="color:#FFCB6B;">nbs:</span><span style="color:#F78C6C;"> 64</span><span style="color:#676E95;font-style:italic;">  # nominal batch size</span></span>
<span class="line"><span style="color:#FFCB6B;">hsv_h:</span><span style="color:#F78C6C;"> 0.015</span><span style="color:#676E95;font-style:italic;">  # image HSV-Hue augmentation (fraction)</span></span>
<span class="line"><span style="color:#FFCB6B;">hsv_s:</span><span style="color:#F78C6C;"> 0.7</span><span style="color:#676E95;font-style:italic;">  # image HSV-Saturation augmentation (fraction)</span></span>
<span class="line"><span style="color:#FFCB6B;">hsv_v:</span><span style="color:#F78C6C;"> 0.4</span><span style="color:#676E95;font-style:italic;">  # image HSV-Value augmentation (fraction)</span></span>
<span class="line"><span style="color:#FFCB6B;">degrees:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # image rotation (+/- deg)</span></span>
<span class="line"><span style="color:#FFCB6B;">translate:</span><span style="color:#F78C6C;"> 0.1</span><span style="color:#676E95;font-style:italic;">  # image translation (+/- fraction)</span></span>
<span class="line"><span style="color:#FFCB6B;">scale:</span><span style="color:#F78C6C;"> 0.5</span><span style="color:#676E95;font-style:italic;">  # image scale (+/- gain)</span></span>
<span class="line"><span style="color:#FFCB6B;">shear:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # image shear (+/- deg)</span></span>
<span class="line"><span style="color:#FFCB6B;">perspective:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # image perspective (+/- fraction), range 0-0.001</span></span>
<span class="line"><span style="color:#FFCB6B;">flipud:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # image flip up-down (probability)</span></span>
<span class="line"><span style="color:#FFCB6B;">fliplr:</span><span style="color:#F78C6C;"> 0.5</span><span style="color:#676E95;font-style:italic;">  # image flip left-right (probability)</span></span>
<span class="line"><span style="color:#FFCB6B;">mosaic:</span><span style="color:#F78C6C;"> 0.2</span><span style="color:#676E95;font-style:italic;">  # image mosaic (probability)</span></span>
<span class="line"><span style="color:#FFCB6B;">mixup:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # image mixup (probability)</span></span>
<span class="line"><span style="color:#FFCB6B;">copy_paste:</span><span style="color:#F78C6C;"> 0.0</span><span style="color:#676E95;font-style:italic;">  # segment copy-paste (probability)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Custom config.yaml ---------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">cfg:</span><span style="color:#676E95;font-style:italic;">  # for overriding defaults.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Debug, do not modify -------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">v5loader:</span><span style="color:#C3E88D;"> False</span><span style="color:#676E95;font-style:italic;">  # use legacy YOLOv5 dataloader</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Tracker settings ------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFCB6B;">tracker:</span><span style="color:#C3E88D;"> botsort.yaml</span><span style="color:#676E95;font-style:italic;">  # tracker type, [&#39;botsort.yaml&#39;, &#39;bytetrack.yaml&#39;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br></div></div><p>训练</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yolo</span><span style="color:#C3E88D;"> train</span><span style="color:#C3E88D;"> data=ultralytics/datasets/coco.yaml</span><span style="color:#C3E88D;"> model=yolov8n.pt</span><span style="color:#C3E88D;"> epochs=</span><span style="color:#F78C6C;">10</span><span style="color:#C3E88D;"> lr0=</span><span style="color:#F78C6C;">0.01</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="warning custom-block"><p class="custom-block-title">说明</p><p>model: 预训练权重模型</p><p><a href="https://main.jtiiot.com:8001/minio-test/otn-file/ai/yolov8n.pt" target="_blank" rel="noreferrer">点击下载 YOLOv8n 在公司服务器</a></p><table><thead><tr><th style="text-align:left;">模型</th><th style="text-align:left;">尺寸(像素)</th><th style="text-align:left;">mAP-val 50-95</th><th style="text-align:left;">速度CPU ONNX(ms)</th><th style="text-align:left;">速度A100 TensorRT(ms)</th><th style="text-align:left;">参数(M)</th><th style="text-align:left;">FLOPs(B)</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8n.pt" target="_blank" rel="noreferrer">YOLOv8n</a></td><td style="text-align:left;">640</td><td style="text-align:left;">37.3</td><td style="text-align:left;">80.4</td><td style="text-align:left;">0.99</td><td style="text-align:left;">3.2</td><td style="text-align:left;">8.7</td></tr><tr><td style="text-align:left;"><a href="https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8s.pt" target="_blank" rel="noreferrer">YOLOv8s</a></td><td style="text-align:left;">640</td><td style="text-align:left;">44.9</td><td style="text-align:left;">128.4</td><td style="text-align:left;">1.20</td><td style="text-align:left;">11.2</td><td style="text-align:left;">28.6</td></tr><tr><td style="text-align:left;"><a href="https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8m.pt" target="_blank" rel="noreferrer">YOLOv8m</a></td><td style="text-align:left;">640</td><td style="text-align:left;">50.2</td><td style="text-align:left;">234.7</td><td style="text-align:left;">1.83</td><td style="text-align:left;">25.9</td><td style="text-align:left;">78.9</td></tr><tr><td style="text-align:left;"><a href="https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8l.pt" target="_blank" rel="noreferrer">YOLOv8l</a></td><td style="text-align:left;">640</td><td style="text-align:left;">52.9</td><td style="text-align:left;">375.2</td><td style="text-align:left;">2.39</td><td style="text-align:left;">43.7</td><td style="text-align:left;">165.2</td></tr><tr><td style="text-align:left;"><a href="https://github.com/ultralytics/assets/releases/download/v0.0.0/yolov8x.pt" target="_blank" rel="noreferrer">YOLOv8x</a></td><td style="text-align:left;">640</td><td style="text-align:left;">53.9</td><td style="text-align:left;">479.1</td><td style="text-align:left;">3.53</td><td style="text-align:left;">68.2</td><td style="text-align:left;">257.8</td></tr></tbody></table><p>epochs: 总共训练轮次</p><p>lr0: 初始学习率</p></div><p>通过上面文件训练生成<code>.pt</code>权重模型文件</p><p>默认目录在<code>runs/detect/train</code></p><p>通过export.py将<code>.pt</code>文件转成<code>.onnx</code>文件</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> ultralytics </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> YOLO</span></span>
<span class="line"><span style="color:#BABED8;">model </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> YOLO</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">r</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">F:</span><span style="color:#BABED8;">\\p</span><span style="color:#C3E88D;">engzhuang3.0</span><span style="color:#BABED8;">\\u</span><span style="color:#C3E88D;">ltralytics-main</span><span style="color:#BABED8;">\\r</span><span style="color:#C3E88D;">uns\\segment</span><span style="color:#BABED8;">\\t</span><span style="color:#C3E88D;">rain\\weights\\best.pt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">success </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> model</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">export</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">format</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">onnx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> half</span><span style="color:#89DDFF;">=False,</span><span style="color:#BABED8;font-style:italic;"> dynamic</span><span style="color:#89DDFF;">=True,</span><span style="color:#BABED8;font-style:italic;"> opset</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">17</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="模型测试-测试训练好的模型-同预期效果进行比对。" tabindex="-1">模型测试：测试训练好的模型，同预期效果进行比对。 <a class="header-anchor" href="#模型测试-测试训练好的模型-同预期效果进行比对。" aria-label="Permalink to &quot;模型测试：测试训练好的模型，同预期效果进行比对。&quot;">​</a></h2><h2 id="模型部署-部署应用。" tabindex="-1">模型部署：部署应用。 <a class="header-anchor" href="#模型部署-部署应用。" aria-label="Permalink to &quot;模型部署：部署应用。&quot;">​</a></h2><p>1️⃣ onnxruntime推理框架部署 用onnxruntime推理框架加载模型, 根据模型入口和出口节点进行配置</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> onnxruntime</span></span>
<span class="line"><span style="color:#BABED8;">...</span></span>
<span class="line"><span style="color:#BABED8;">rtconfig </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> onnxruntime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SessionOptions</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 设置CPU线程数为</span></span>
<span class="line"><span style="color:#BABED8;">cpu_num_thread </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;"> 3</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 设置执行模式为ORT_SEQUENTIAL(即顺序执行)</span></span>
<span class="line"><span style="color:#BABED8;">rtconfig</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">intra_op_num_threads</span><span style="color:#89DDFF;"> =</span><span style="color:#BABED8;"> cpu_num_thread</span></span>
<span class="line"><span style="color:#BABED8;">rtconfig</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">execution_mode</span><span style="color:#89DDFF;"> =</span><span style="color:#BABED8;"> onnxruntime</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">ExecutionMode</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">ORT_SEQUENTIAL</span></span>
<span class="line"><span style="color:#BABED8;">device </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">cpu</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> device </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">cpu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    providers </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CPUExecutionProvider</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">elif</span><span style="color:#BABED8;"> device </span><span style="color:#89DDFF;">==</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">gpu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    providers </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CUDAExecutionProvider</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">CPUExecutionProvider</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">model_path </span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;"> r</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">F:</span><span style="color:#BABED8;">\\p</span><span style="color:#C3E88D;">engzhuang3.0</span><span style="color:#BABED8;">\\u</span><span style="color:#C3E88D;">ltralytics-main</span><span style="color:#BABED8;">\\r</span><span style="color:#C3E88D;">uns\\detect</span><span style="color:#BABED8;">\\t</span><span style="color:#C3E88D;">rain\\weights\\best.onnx</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">session </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> onnxruntime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">InferenceSession</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">model_path</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> providers</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">providers</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> sess_options</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">rtconfig</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">model_outputs </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_outputs</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">output_names </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> [</span><span style="color:#BABED8;">model_outputs</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">i</span><span style="color:#89DDFF;">].</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;font-style:italic;"> for</span><span style="color:#BABED8;"> i </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#82AAFF;"> range</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">model_outputs</span><span style="color:#89DDFF;">))]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">model_inputs </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_inputs</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">input_names </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;"> [</span><span style="color:#BABED8;">model_inputs</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">i</span><span style="color:#89DDFF;">].</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;font-style:italic;"> for</span><span style="color:#BABED8;"> i </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#82AAFF;"> range</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">model_inputs</span><span style="color:#89DDFF;">))]</span></span>
<span class="line"><span style="color:#BABED8;">...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>函数的输出其实就是 <code>图片文件同名的.txt</code>的内容及图片中预测物体的位置和置信度</p><p>然后通过<code>openCV</code>画框</p><p>2️⃣ TENSORT推理框架部署</p>`,56),F=[y];function D(b,u,m,d,C,B){return a(),n("div",null,F)}const g=s(i,[["render",D]]);export{E as __pageData,g as default};
