import{_ as a,c as s,o as l,a4 as n,b2 as e,b3 as p,b4 as o,b5 as t,b6 as r,b7 as c,b8 as i}from"./chunks/framework.CCJHkvW2.js";const E=JSON.parse('{"title":"Ollama","description":"","frontmatter":{},"headers":[],"relativePath":"ai/ollama.md","filePath":"ai/ollama.md","lastUpdated":1713833896000}'),d={name:"ai/ollama.md"},m=n(`<h1 id="ollama" tabindex="-1">Ollama <a class="header-anchor" href="#ollama" aria-label="Permalink to &quot;Ollama&quot;">​</a></h1><p>参考文献(<a href="http://www.eryajf.net/pages/97047e/#%E6%A8%A1%E5%9E%8B%E7%AE%A1%E7%90%86" target="_blank" rel="noreferrer">http://www.eryajf.net/pages/97047e/#模型管理</a>)(<a href="https://blog.csdn.net/qyhua/article/details/136875458" target="_blank" rel="noreferrer">https://blog.csdn.net/qyhua/article/details/136875458</a>)</p><p>github(<a href="https://github.com/ollama/ollama" target="_blank" rel="noreferrer">https://github.com/ollama/ollama</a>)</p><p><strong>Ollama</strong>是一个开源的大型语言模型服务,提供了类似OpenAI的API接口和聊天界面,可以非常方便地部署最新版本的GPT模型并通过接口使用。支持热加载模型文件,无需重新启动即可切换不同的模型.</p><p>Ollama的优势</p><p>提供类似OpenAI的简单内容生成接口,极易上手使用</p><p>类似ChatGPT的的聊天界面,无需开发直接与模型聊天</p><p>支持热切换模型,灵活多变</p><p>Ollama 是 Hugging Face 的一种替代方案,用于在本地运行模型</p><p>Hugging Face 库运行在 TensorFlow 或 Torch 之上</p><p>而 Ollama 使用 llama.cpp 作为底层运行时。这使 Ollama 的上手变得非常简单。</p><div class="tip custom-block"><p class="custom-block-title">Ollama 提供了多个模型，每个都有其特点和适用场景：</p><p>Llama 2：这是一个预训练(基于Llama 1的参数)的大型语言模型，具有7B、13B和70B三种不同规模的模型。Llama 2增加了预训练语料，上下文长度从2048提升到4096， 使得模型能够理解和生成更长的文本。</p><p>OpenHermes：这个模型专注于代码生成和编程任务，适合用于软件开发和脚本编写等场景。</p><p>Solar：这是一个基于Llama 2的微调版本，专为对话场景优化。Solar在安全性和有用性方面进行了人工评估和改进，旨在成为封闭源模型的有效替代品。</p><p>Qwen:7B：这是一个中文微调过的模型，特别适合处理中文文本。它需要至少8GB的内存进行推理，推荐配备16GB以流畅运行</p></div><h2 id="docker-安装ollama" tabindex="-1">docker 安装ollama <a class="header-anchor" href="#docker-安装ollama" aria-label="Permalink to &quot;docker 安装ollama&quot;">​</a></h2><p>官方镜像地址(<a href="https://hub.docker.com/r/ollama/ollama" target="_blank" rel="noreferrer">https://hub.docker.com/r/ollama/ollama</a>)</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#C3E88D;"> run</span><span style="color:#C3E88D;"> -d</span><span style="color:#C3E88D;"> --gpus=all</span><span style="color:#C3E88D;"> -v</span><span style="color:#C3E88D;"> /docker/ollama:/root/.ollama</span><span style="color:#C3E88D;"> -p</span><span style="color:#C3E88D;"> 11435:11434</span><span style="color:#C3E88D;"> -e</span><span style="color:#C3E88D;"> OLLAMA_HOST=</span><span style="color:#F78C6C;">0.0.0.0</span><span style="color:#C3E88D;"> -e</span><span style="color:#C3E88D;"> OLLAMA_ORIGINS=</span><span style="color:#BABED8;">*</span><span style="color:#C3E88D;"> --restart</span><span style="color:#C3E88D;"> always</span><span style="color:#C3E88D;"> --name</span><span style="color:#C3E88D;"> ollama-zhangling</span><span style="color:#C3E88D;"> ollama/ollama</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">  ollama</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">    container_name</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> ollama-zhangling</span></span>
<span class="line"><span style="color:#F07178;">    image</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> ollama/ollama:latest</span></span>
<span class="line"><span style="color:#F07178;">    restart</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> always</span></span>
<span class="line"><span style="color:#F07178;">    ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">      -</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">11435:11434</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">    volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">      -</span><span style="color:#C3E88D;"> /data/ollama:/root/.ollama</span></span>
<span class="line"><span style="color:#F07178;">    environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">      OLLAMA_ORIGINS</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">      OLLAMA_HOST</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">0.0.0.0</span><span style="color:#89DDFF;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">环境变量</p><p>OLLAMA_HOST：这个变量定义了Ollama监听的网络接口。通过设置OLLAMA_HOST=0.0.0.0，我们可以让Ollama监听所有可用的网络接口，从而允许外部网络访问。</p><p>OLLAMA_MODELS：这个变量指定了模型镜像的存储路径。通过设置OLLAMA_MODELS=F:\\OllamaCache，我们可以将模型镜像存储在E盘，避免C盘空间不足的问题。</p><p>OLLAMA_KEEP_ALIVE：这个变量控制模型在内存中的存活时间。设置OLLAMA_KEEP_ALIVE=24h可以让模型在内存中保持24小时，提高访问速度。</p><p>OLLAMA_PORT：这个变量允许我们更改Ollama的默认端口。例如，设置OLLAMA_PORT=8080可以将服务端口从默认的11434更改为8080。</p><p>OLLAMA_NUM_PARALLEL：这个变量决定了Ollama可以同时处理的用户请求数量。设置OLLAMA_NUM_PARALLEL=4可以让Ollama同时处理两个并发请求。</p><p>OLLAMA_MAX_LOADED_MODELS：这个变量限制了Ollama可以同时加载的模型数量。设置OLLAMA_MAX_LOADED_MODELS=4可以确保系统资源得到合理分配。</p></div><p>测试是否启动</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> 172.26.25.35:11435</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>结果: Ollama is running</p><p>进入容器</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#C3E88D;"> exec</span><span style="color:#C3E88D;"> -it</span><span style="color:#C3E88D;"> ollama-zhangling</span><span style="color:#C3E88D;"> /bin/bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="常用指令" tabindex="-1">常用指令 <a class="header-anchor" href="#常用指令" aria-label="Permalink to &quot;常用指令&quot;">​</a></h3><p>显示模型列表。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> list</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>显示模型的信息</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> show</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>拉取模型</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> pull</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>推送模型</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> push</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>拷贝一个模型</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> cp</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>删除一个模型</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> rm</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>运行一个模型</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> run</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">指令说明</p><p>ollama list ：显示模型列表。</p><p>ollama show ：显示模型的信息</p><p>ollama pull ：拉取模型</p><p>ollama push ：推送模型</p><p>ollama cp ：拷贝一个模型</p><p>ollama rm ：删除一个模型</p><p>ollama run ：运行一个模型</p></div><h2 id="拉取模型" tabindex="-1">拉取模型 <a class="header-anchor" href="#拉取模型" aria-label="Permalink to &quot;拉取模型&quot;">​</a></h2><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> pull</span><span style="color:#C3E88D;"> qwen:7b</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>结果: pulling manifest pulling 87f26aae09c7... 22% ▕</p><div class="tip custom-block"><p class="custom-block-title">也可下载模型</p><p>进入ollama(<a href="https://ollama.com/library" target="_blank" rel="noreferrer">https://ollama.com/library</a>),下载qwen:7b</p></div><h2 id="运行模型" tabindex="-1">运行模型 <a class="header-anchor" href="#运行模型" aria-label="Permalink to &quot;运行模型&quot;">​</a></h2><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ollama</span><span style="color:#C3E88D;"> run</span><span style="color:#C3E88D;"> qwen:7b</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="集成ollama的-webui" tabindex="-1">集成Ollama的 WEBUI <a class="header-anchor" href="#集成ollama的-webui" aria-label="Permalink to &quot;集成Ollama的 WEBUI&quot;">​</a></h2><p>github(<a href="https://github.com/lobehub/lobe-chat" target="_blank" rel="noreferrer">https://github.com/lobehub/lobe-chat</a>)</p><p>文档(<a href="https://lobehub.com/zh/docs/usage/providers/ollama" target="_blank" rel="noreferrer">https://lobehub.com/zh/docs/usage/providers/ollama</a>)(<a href="https://lobehub.github.io/lobe-chat/docs/getting-started/installation" target="_blank" rel="noreferrer">https://lobehub.github.io/lobe-chat/docs/getting-started/installation</a>)</p><p>docker 安装<code>lobe-chat</code> WEBUI</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#C3E88D;"> run</span><span style="color:#C3E88D;"> -d</span><span style="color:#C3E88D;">  --name=lobechat</span><span style="color:#C3E88D;"> -p</span><span style="color:#C3E88D;"> 3210:3210</span><span style="color:#C3E88D;"> -e</span><span style="color:#C3E88D;"> OPENAI_API_KEY=zhangling</span><span style="color:#C3E88D;"> -e</span><span style="color:#C3E88D;"> ACCESS_CODE=Zhangling@</span><span style="color:#C3E88D;"> -e</span><span style="color:#C3E88D;"> OLLAMA_PROXY_URL=http://172.26.25.35:11435/v1</span><span style="color:#C3E88D;"> -e</span><span style="color:#C3E88D;"> OPENAI_PROXY_URL=https://api.openai.com/v1</span><span style="color:#C3E88D;"> lobehub/lobe-chat</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>webui 地址</p><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">http://172.26.25.35:3210</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="开发工具集成使用模型" tabindex="-1">开发工具集成使用模型 <a class="header-anchor" href="#开发工具集成使用模型" aria-label="Permalink to &quot;开发工具集成使用模型&quot;">​</a></h2><h3 id="jetbrains-ides-安装codegpt插件" tabindex="-1">JetBrains IDEs 安装CodeGPT插件 <a class="header-anchor" href="#jetbrains-ides-安装codegpt插件" aria-label="Permalink to &quot;JetBrains IDEs 安装CodeGPT插件&quot;">​</a></h3><p>配置</p><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">http://172.26.25.35:11434/v1/chat/completions</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>model</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span>qwen:7b</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+e+'" alt="An image"></p><p><img src="'+p+'" alt="An image"></p><p>自定义action命令 <img src="'+o+'" alt="An image"></p><p>选择一段代码，右键点击</p><p><img src="'+t+'" alt="An image"></p><h3 id="visual-studio-code安装continue" tabindex="-1">Visual Studio Code安装continue <a class="header-anchor" href="#visual-studio-code安装continue" aria-label="Permalink to &quot;Visual Studio Code安装continue&quot;">​</a></h3><p>配置 <img src="'+r+`" alt="An image"></p><p>config.json 添加</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">&quot;models&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#BABED8;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">   {</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;title&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">qwen</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#676E95;font-style:italic;"> # 自己命令</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;provider&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">ollama</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;model&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">qwen:7b</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;apiBase&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">http://172.26.25.35:11434</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">   }</span><span style="color:#BABED8;">,</span></span>
<span class="line"><span style="color:#82AAFF;">.....</span></span>
<span class="line"><span style="color:#BABED8;">]</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#这是自定义斜杠命令</span></span>
<span class="line"><span style="color:#FFCB6B;">&quot;customCommands&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#BABED8;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">     {</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;name&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">解释</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;prompt&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">解释这段代码</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#FFCB6B;">       &quot;description&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#FFCB6B;">&quot;解释这段代码&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">     }</span></span>
<span class="line"><span style="color:#82AAFF;">.....</span></span>
<span class="line"><span style="color:#BABED8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>保存后没生效则退出VSCode，重新打开。</p><p>使用方法 选择一段代码，右键点击</p><p><img src="`+c+'" alt="An image"></p><p>在聊天窗口中输入斜杠(/)，然后选择你自定义的命令“解释”，它会将当前选中的代码发送到ollama服务器并显示结果。 <img src="'+i+'" alt="An image"></p>',70),u=[m];function b(h,y,D,F,C,g){return l(),s("div",null,u)}const A=a(d,[["render",b]]);export{E as __pageData,A as default};
